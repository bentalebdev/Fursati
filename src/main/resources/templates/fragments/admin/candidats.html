<div th:fragment="candidats" xmlns:th="http://www.thymeleaf.org">
  <div class="app-card mb-4">
    <div class="app-card-header">
      <h5 class="app-card-title">Filtres</h5>
    </div>
    <div class="app-card-body">
      <div class="row">
        <div class="col-md-3 mb-3">
          <label class="form-label">Statut</label>
          <select class="form-select">
            <option value="">Tous les statuts</option>
            <option value="active">Actif</option>
            <option value="pending">En attente</option>
            <option value="blocked">Bloqué</option>
          </select>
        </div>
        <div class="col-md-3 mb-3">
          <label class="form-label">Compétences</label>
          <select class="form-select">
            <option value="">Toutes les compétences</option>
            <option value="dev">Développement</option>
            <option value="design">Design</option>
            <option value="marketing">Marketing</option>
          </select>
        </div>
        <div class="col-md-3 mb-3">
          <label class="form-label">Ville</label>
          <select class="form-select">
            <option value="">Toutes les villes</option>
            <option value="Casablanca">Casablanca</option>
            <option value="Rabat">Rabat</option>
            <option value="Marrakech">Marrakech</option>
            <option value="Tanger">Tanger</option>
            <option value="Fès">Fès</option>
          </select>
        </div>
        <div class="col-md-3 mb-3">
          <label class="form-label">Âge</label>
          <select class="form-select">
            <option value="">Tous les âges</option>
            <option value="18-25">18-25 ans</option>
            <option value="26-35">26-35 ans</option>
            <option value="36-45">36-45 ans</option>
            <option value="46+">46+ ans</option>
          </select>
        </div>
      </div>
      <div class="row">
        <div class="col-md-6 mb-3">
          <label class="form-label">Recherche</label>
          <input type="text" class="form-control" placeholder="Nom, email, téléphone...">
        </div>
        <div class="col-md-6 d-flex align-items-end justify-content-end mb-3">
          <button class="btn btn-primary me-2">Appliquer les filtres</button>
          <button class="btn btn-outline-secondary">Réinitialiser</button>
        </div>
      </div>
    </div>
  </div>

  <div class="app-card">
    <div class="app-card-header">
      <h5 class="app-card-title">Candidats</h5>
      <div>
        <button class="btn btn-sm btn-success me-2">
          <i class="fas fa-plus me-1"></i> Ajouter
        </button>
        <button class="btn btn-sm btn-outline-secondary me-2">
          <i class="fas fa-download me-1"></i> Exporter
        </button>
        <button class="btn btn-sm btn-outline-danger">
          <i class="fas fa-trash me-1"></i> Supprimer
        </button>
      </div>
    </div>
    <div class="app-card-body p-0">
      <div class="table-responsive">
        <table class="table table-hover mb-0">
          <thead>
          <tr>
            <th width="40">
              <div class="form-check">
                <input class="form-check-input" type="checkbox" id="selectAll">
              </div>
            </th>
            <th>Nom</th>
            <th>Email</th>
            <th>Téléphone</th>
            <th>Adresse</th>
            <th>Date de naissance</th>
            <th>Compétences</th>
            <th>Actions</th>
          </tr>
          </thead>
          <tbody>
          <!-- Loop through candidates using Thymeleaf -->
          <tr th:each="candidat : ${candidats}">
            <td>
              <div class="form-check">
                <input class="form-check-input" type="checkbox" th:value="${candidat.id}">
              </div>
            </td>
            <td>
              <div class="d-flex align-items-center">
                <!-- Show profile picture if available, otherwise use initials -->
                <div th:if="${candidat.profilePicture != null && !candidat.profilePicture.isEmpty()}" class="me-2">
                  <img th:src="${candidat.profilePicture}" alt="Profile" width="32" height="32" class="rounded-circle">
                </div>
                <div th:unless="${candidat.profilePicture != null && !candidat.profilePicture.isEmpty()}"
                     class="avatar avatar-sm me-2 bg-primary rounded"
                     th:text="${#strings.substring(candidat.firstName, 0, 1) + #strings.substring(candidat.lastName, 0, 1)}">
                </div>
                <div th:text="${candidat.firstName + ' ' + candidat.lastName}">Nom Complet</div>
              </div>
            </td>
            <td th:text="${candidat.email}">email@example.com</td>
            <td th:text="${candidat.phone}">Téléphone</td>
            <td th:text="${candidat.address}">Adresse</td>
            <td th:text="${#temporals.format(candidat.birthdate, 'dd/MM/yyyy')}">Date de naissance</td>
            <td>
              <!-- Show first 2 skills if available -->
              <div th:if="${!candidat.skills.empty}">
                <span class="badge bg-light text-dark me-1" th:each="skill, status : ${candidat.skills}" th:if="${status.index < 2}" th:text="${skill.name}">Compétence</span>
                <small th:if="${candidat.skills.size() > 2}" th:text="'+ ' + (${candidat.skills.size() - 2})"></small>
              </div>
              <span th:if="${candidat.skills.empty}" class="text-muted">Aucune compétence</span>
            </td>
            <td>
              <div class="dropdown">
                <button class="btn btn-sm btn-outline-secondary dropdown-toggle" type="button" data-bs-toggle="dropdown">
                  Actions
                </button>
                <ul class="dropdown-menu">
                  <li><a class="dropdown-item" th:href="@{/admin/candidats/details/{id}(id=${candidat.id})}">Voir détails</a></li>
                  <li><a class="dropdown-item" th:href="@{/admin/candidats/edit/{id}(id=${candidat.id})}">Modifier</a></li>
                  <li><a class="dropdown-item" th:href="@{/admin/candidats/toggle-status/{id}(id=${candidat.id})}">Changer statut</a></li>
                  <li><a class="dropdown-item text-danger" th:href="@{/admin/candidats/delete/{id}(id=${candidat.id})}">Supprimer</a></li>
                </ul>
              </div>
            </td>
          </tr>
          <!-- Empty state message when no candidates are found -->
          <tr th:if="${candidats.empty}">
            <td colspan="8" class="text-center py-4">
              <div class="text-muted">Aucun candidat n'a été trouvé</div>
            </td>
          </tr>
          </tbody>
        </table>
      </div>
    </div>
    <div class="app-card-footer p-3">
      <div class="d-flex justify-content-between align-items-center">
        <div>Affichage de <span th:text="${candidats.size() > 0 ? 1 : 0}"></span> à <span th:text="${candidats.size()}"></span> sur <span th:text="${candidats.size()}"></span> entrées</div>
        <!-- Pagination would go here - this is a simplified version -->
        <nav>
          <ul class="pagination pagination-sm mb-0">
            <li class="page-item disabled"><a class="page-link" href="#">Précédent</a></li>
            <li class="page-item active"><a class="page-link" href="#">1</a></li>
            <li class="page-item"><a class="page-link" href="#">Suivant</a></li>
          </ul>
        </nav>
      </div>
    </div>
  </div>
</div>