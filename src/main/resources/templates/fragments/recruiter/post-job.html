<!-- Post Job Fragment - Static Version -->
<div th:fragment="post-job">
  <!-- Form container -->
  <div class="card">
    <div class="card-body">
      <form class="job-form needs-validation" novalidate>
        <!-- Progress steps -->
        <div class="post-job-progress mb-4">
          <div class="row">
            <div class="col-md-3">
              <div class="progress-step active" id="step1-indicator">
                <div class="progress-step-number">1</div>
                <div class="progress-step-label">Informations générales</div>
              </div>
            </div>
            <div class="col-md-3">
              <div class="progress-step" id="step2-indicator">
                <div class="progress-step-number">2</div>
                <div class="progress-step-label">Détails du poste</div>
              </div>
            </div>
            <div class="col-md-3">
              <div class="progress-step" id="step3-indicator">
                <div class="progress-step-number">3</div>
                <div class="progress-step-label">Compétences requises</div>
              </div>
            </div>
            <div class="col-md-3">
              <div class="progress-step" id="step4-indicator">
                <div class="progress-step-number">4</div>
                <div class="progress-step-label">Publication</div>
              </div>
            </div>
          </div>
          <div class="progress mt-2">
            <div class="progress-bar bg-primary" role="progressbar" style="width: 25%" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100" id="progress-bar"></div>
          </div>
        </div>

        <!-- Step 1: Informations générales -->
        <div class="form-step active" id="step1">
          <h4 class="form-section-title">Informations générales</h4>
          <p class="text-muted mb-4">Fournissez des informations de base sur l'offre d'emploi.</p>

          <div class="row mb-3">
            <div class="col-md-6">
              <label for="jobTitle" class="form-label">Titre du poste *</label>
              <input type="text" class="form-control" id="jobTitle" name="title" required>
              <div class="invalid-feedback">Le titre du poste est requis.</div>
            </div>
            <div class="col-md-6">
              <label for="department" class="form-label">Département</label>
              <select class="form-select" id="department" name="department">
                <option value="">Sélectionner un département</option>
                <option value="IT">Informatique</option>
                <option value="FINANCE">Finance</option>
                <option value="MARKETING">Marketing</option>
                <option value="SALES">Ventes</option>
                <option value="HR">Ressources Humaines</option>
                <option value="OPERATIONS">Opérations</option>
                <option value="ADMINISTRATION">Administration</option>
                <option value="OTHER">Autre</option>
              </select>
            </div>
          </div>

          <div class="row mb-3">
            <div class="col-md-6">
              <label for="jobType" class="form-label">Type de contrat *</label>
              <select class="form-select" id="jobType" name="jobType" required>
                <option value="">Sélectionner un type</option>
                <option value="FULL_TIME">Temps plein</option>
                <option value="PART_TIME">Temps partiel</option>
                <option value="CONTRACT">Contrat</option>
                <option value="FREELANCE">Freelance</option>
                <option value="INTERNSHIP">Stage</option>
                <option value="APPRENTICESHIP">Alternance</option>
              </select>
              <div class="invalid-feedback">Le type de contrat est requis.</div>
            </div>
            <div class="col-md-6">
              <label for="workArrangement" class="form-label">Mode de travail *</label>
              <select class="form-select" id="workArrangement" name="workArrangement" required>
                <option value="">Sélectionner un mode</option>
                <option value="ONSITE">Sur site</option>
                <option value="REMOTE">Télétravail</option>
                <option value="HYBRID">Hybride</option>
              </select>
              <div class="invalid-feedback">Le mode de travail est requis.</div>
            </div>
          </div>

          <div class="row mb-3">
            <div class="col-md-6">
              <label for="location" class="form-label">Lieu *</label>
              <input type="text" class="form-control" id="location" name="location" required>
              <div class="invalid-feedback">Le lieu est requis.</div>
            </div>
            <div class="col-md-6">
              <label for="experienceLevel" class="form-label">Niveau d'expérience *</label>
              <select class="form-select" id="experienceLevel" name="experienceLevel" required>
                <option value="">Sélectionner un niveau</option>
                <option value="ENTRY">Débutant (0-2 ans)</option>
                <option value="JUNIOR">Junior (2-3 ans)</option>
                <option value="MID_LEVEL">Intermédiaire (3-5 ans)</option>
                <option value="SENIOR">Sénior (5-10 ans)</option>
                <option value="EXPERT">Expert (10+ ans)</option>
              </select>
              <div class="invalid-feedback">Le niveau d'expérience est requis.</div>
            </div>
          </div>

          <div class="row mb-3">
            <div class="col-md-6">
              <label for="minSalary" class="form-label">Salaire minimum (MAD/an)</label>
              <input type="number" class="form-control" id="minSalary" name="minSalary">
            </div>
            <div class="col-md-6">
              <label for="maxSalary" class="form-label">Salaire maximum (MAD/an)</label>
              <input type="number" class="form-control" id="maxSalary" name="maxSalary">
            </div>
          </div>

          <div class="form-check mb-3">
            <input class="form-check-input" type="checkbox" id="showSalaryRange" name="showSalaryRange">
            <label class="form-check-label" for="showSalaryRange">
              Afficher la fourchette de salaire aux candidats
            </label>
          </div>

          <div class="d-flex justify-content-end mt-4">
            <button type="button" class="btn btn-primary next-step" data-target="step2">
              Suivant <i class="fas fa-arrow-right ms-2"></i>
            </button>
          </div>
        </div>

        <!-- Step 2: Détails du poste -->
        <div class="form-step" id="step2">
          <h4 class="form-section-title">Détails du poste</h4>
          <p class="text-muted mb-4">Décrivez le poste, les responsabilités et les qualifications requises.</p>

          <div class="mb-3">
            <label for="shortDescription" class="form-label">Description courte (max. 150 caractères) *</label>
            <input type="text" class="form-control" id="shortDescription" name="shortDescription" maxlength="150" required>
            <div class="invalid-feedback">Une description courte est requise.</div>
            <div class="form-text text-end">
              <span id="shortDescCounter">0</span>/150 caractères
            </div>
          </div>

          <div class="mb-3">
            <label for="description" class="form-label">Description complète *</label>
            <textarea class="form-control rich-editor" id="description" name="description" rows="6" required></textarea>
            <div class="invalid-feedback">Une description complète est requise.</div>
          </div>

          <div class="mb-3">
            <label for="responsibilities" class="form-label">Responsabilités *</label>
            <textarea class="form-control rich-editor" id="responsibilities" name="responsibilities" rows="6" required></textarea>
            <div class="invalid-feedback">Les responsabilités sont requises.</div>
            <div class="form-text">Utilisez une liste à puces pour une meilleure lisibilité.</div>
          </div>

          <div class="mb-3">
            <label for="requirements" class="form-label">Qualifications requises *</label>
            <textarea class="form-control rich-editor" id="requirements" name="requirements" rows="6" required></textarea>
            <div class="invalid-feedback">Les qualifications requises sont nécessaires.</div>
            <div class="form-text">Indiquez l'éducation, l'expérience et les certifications attendues.</div>
          </div>

          <div class="mb-3">
            <label for="benefits" class="form-label">Avantages</label>
            <textarea class="form-control rich-editor" id="benefits" name="benefits" rows="4"></textarea>
            <div class="form-text">Mettez en avant les avantages de travailler pour votre entreprise.</div>
          </div>

          <div class="d-flex justify-content-between mt-4">
            <button type="button" class="btn btn-outline-secondary prev-step" data-target="step1">
              <i class="fas fa-arrow-left me-2"></i> Précédent
            </button>
            <button type="button" class="btn btn-primary next-step" data-target="step3">
              Suivant <i class="fas fa-arrow-right ms-2"></i>
            </button>
          </div>
        </div>

        <!-- Step 3: Compétences requises -->
        <div class="form-step" id="step3">
          <h4 class="form-section-title">Compétences requises</h4>
          <p class="text-muted mb-4">Précisez les compétences techniques et non techniques requises pour le poste.</p>

          <div class="mb-4">
            <label class="form-label">Compétences techniques *</label>
            <div class="skills-container mb-2" id="technicalSkills">
              <div class="input-group mb-2">
                <input type="text" class="form-control skill-input" placeholder="Ajouter une compétence">
                <button class="btn btn-outline-secondary add-skill" type="button">
                  <i class="fas fa-plus"></i>
                </button>
              </div>
              <div class="selected-skills">
                <!-- Exemples de compétences sélectionnées -->
                <div class="skill-badge">
                  JavaScript <button class="remove-badge"><i class="fas fa-times"></i></button>
                </div>
                <div class="skill-badge">
                  React <button class="remove-badge"><i class="fas fa-times"></i></button>
                </div>
                <div class="skill-badge">
                  Node.js <button class="remove-badge"><i class="fas fa-times"></i></button>
                </div>
              </div>
              <input type="hidden" name="technicalSkills" value="JavaScript,React,Node.js">
            </div>
            <div id="technicalSkillsRequired" class="invalid-feedback">Au moins une compétence technique est requise.</div>
            <div class="form-text">Ajoutez des langages de programmation, technologies, logiciels, etc.</div>
          </div>

          <div class="mb-4">
            <label class="form-label">Compétences non techniques</label>
            <div class="skills-container mb-2" id="softSkills">
              <div class="input-group mb-2">
                <input type="text" class="form-control skill-input" placeholder="Ajouter une compétence">
                <button class="btn btn-outline-secondary add-skill" type="button">
                  <i class="fas fa-plus"></i>
                </button>
              </div>
              <div class="selected-skills">
                <!-- Exemples de compétences sélectionnées -->
                <div class="skill-badge">
                  Communication <button class="remove-badge"><i class="fas fa-times"></i></button>
                </div>
                <div class="skill-badge">
                  Travail d'équipe <button class="remove-badge"><i class="fas fa-times"></i></button>
                </div>
              </div>
              <input type="hidden" name="softSkills" value="Communication,Travail d'équipe">
            </div>
            <div class="form-text">Ajoutez des compétences comme la communication, le travail d'équipe, etc.</div>
          </div>

          <div class="mb-4">
            <label class="form-label">Langues</label>
            <div class="skills-container mb-2" id="languages">
              <div class="input-group mb-2">
                <input type="text" class="form-control skill-input" placeholder="Ajouter une langue">
                <select class="form-select language-level" style="max-width: 150px;">
                  <option value="BASIC">Débutant</option>
                  <option value="INTERMEDIATE">Intermédiaire</option>
                  <option value="ADVANCED">Avancé</option>
                  <option value="FLUENT">Courant</option>
                  <option value="NATIVE">Natif</option>
                </select>
                <button class="btn btn-outline-secondary add-language" type="button">
                  <i class="fas fa-plus"></i>
                </button>
              </div>
              <div class="selected-languages">
                <!-- Exemples de langues sélectionnées -->
                <div class="language-badge">
                  <span class="language-name">Français</span>
                  <span class="language-level">Natif</span>
                  <button class="remove-badge"><i class="fas fa-times"></i></button>
                </div>
                <div class="language-badge">
                  <span class="language-name">Anglais</span>
                  <span class="language-level">Courant</span>
                  <button class="remove-badge"><i class="fas fa-times"></i></button>
                </div>
              </div>
              <input type="hidden" name="languages" value="Français:NATIVE,Anglais:FLUENT">
            </div>
          </div>

          <div class="mb-3">
            <label for="educationLevel" class="form-label">Niveau d'éducation minimum</label>
            <select class="form-select" id="educationLevel" name="educationLevel">
              <option value="">Aucun</option>
              <option value="HIGH_SCHOOL">Baccalauréat</option>
              <option value="ASSOCIATE">Bac+2</option>
              <option value="BACHELOR" selected>Licence (Bac+3)</option>
              <option value="MASTER">Master (Bac+5)</option>
              <option value="DOCTORATE">Doctorat</option>
            </select>
          </div>

          <div class="mb-3">
            <label for="certifications" class="form-label">Certifications souhaitées</label>
            <input type="text" class="form-control" id="certifications" name="certifications" placeholder="Ex: PMP, ITIL, CFA, etc." value="Agile, Scrum">
          </div>

          <div class="d-flex justify-content-between mt-4">
            <button type="button" class="btn btn-outline-secondary prev-step" data-target="step2">
              <i class="fas fa-arrow-left me-2"></i> Précédent
            </button>
            <button type="button" class="btn btn-primary next-step" data-target="step4">
              Suivant <i class="fas fa-arrow-right ms-2"></i>
            </button>
          </div>
        </div>

        <!-- Step 4: Publication -->
        <div class="form-step" id="step4">
          <h4 class="form-section-title">Publication de l'offre</h4>
          <p class="text-muted mb-4">Configurez les détails de la publication et affichez un aperçu.</p>

          <div class="row mb-4">
            <div class="col-md-6">
              <label for="applicationDeadline" class="form-label">Date limite de candidature</label>
              <input type="date" class="form-control" id="applicationDeadline" name="applicationDeadline" value="2025-05-18">
            </div>
            <div class="col-md-6">
              <label for="publicationDuration" class="form-label">Durée de publication</label>
              <select class="form-select" id="publicationDuration" name="publicationDuration">
                <option value="15">15 jours</option>
                <option value="30" selected>30 jours</option>
                <option value="60">60 jours</option>
                <option value="90">90 jours</option>
              </select>
            </div>
          </div>

          <div class="row mb-4">
            <div class="col-md-6">
              <label for="maxApplications" class="form-label">Nombre maximum de candidatures</label>
              <input type="number" class="form-control" id="maxApplications" name="maxApplications" value="50">
              <div class="form-text">Laissez vide pour un nombre illimité</div>
            </div>
            <div class="col-md-6">
              <label for="visibility" class="form-label">Visibilité</label>
              <select class="form-select" id="visibility" name="visibility">
                <option value="PUBLIC" selected>Publique</option>
                <option value="PRIVATE">Privée (sur invitation uniquement)</option>
              </select>
            </div>
          </div>

          <div class="mb-4">
            <div class="form-check form-switch">
              <input class="form-check-input" type="checkbox" id="screeningQuestions" name="enableScreeningQuestions">
              <label class="form-check-label" for="screeningQuestions">
                Activer les questions de présélection
              </label>
            </div>
            <div class="form-text">Les questions de présélection peuvent vous aider à identifier les candidats les plus qualifiés.</div>

            <div id="screeningQuestionsForm" class="mt-3 d-none">
              <div class="card">
                <div class="card-body bg-light">
                  <h6>Questions de présélection</h6>
                  <div id="questionsContainer">
                    <div class="question-item mb-3">
                      <div class="input-group">
                        <input type="text" class="form-control" placeholder="Entrez une question" value="Combien d'années d'expérience avez-vous en développement JavaScript?">
                        <button class="btn btn-outline-danger remove-question" type="button">
                          <i class="fas fa-trash"></i>
                        </button>
                      </div>
                    </div>
                    <div class="question-item mb-3">
                      <div class="input-group">
                        <input type="text" class="form-control" placeholder="Entrez une question" value="Avez-vous déjà travaillé dans un environnement Agile?">
                        <button class="btn btn-outline-danger remove-question" type="button">
                          <i class="fas fa-trash"></i>
                        </button>
                      </div>
                    </div>
                  </div>
                  <button type="button" class="btn btn-sm btn-outline-primary mt-2" id="addQuestion">
                    <i class="fas fa-plus"></i> Ajouter une question
                  </button>
                  <input type="hidden" name="screeningQuestions" value="Combien d'années d'expérience avez-vous en développement JavaScript?,Avez-vous déjà travaillé dans un environnement Agile?">
                </div>
              </div>
            </div>
          </div>

          <div class="mb-4">
            <div class="form-check form-switch">
              <input class="form-check-input" type="checkbox" id="publishNow" checked>
              <label class="form-check-label" for="publishNow">
                Publier maintenant
              </label>
            </div>
            <div class="scheduled-date d-none mt-3">
              <label for="publicationDate" class="form-label">Date de publication</label>
              <input type="datetime-local" class="form-control" id="publicationDate" name="publicationDate">
            </div>
          </div>

          <div class="card mb-4">
            <div class="card-header">
              <h5 class="mb-0">Aperçu de l'offre</h5>
            </div>
            <div class="card-body">
              <div class="job-preview">
                <h4 id="preview-title">Développeur Frontend</h4>
                <p class="text-muted mb-2">
                  <span id="preview-location">Casablanca</span> •
                  <span id="preview-jobType">Temps plein</span> •
                  <span id="preview-department">Informatique</span>
                </p>
                <div class="mb-3">
                  <span class="badge bg-primary me-1">Nouveau</span>
                  <span id="preview-experienceLevel" class="badge bg-secondary me-1">Intermédiaire (3-5 ans)</span>
                  <span id="preview-workArrangement" class="badge bg-info text-dark">Hybride</span>
                </div>
                <p id="preview-shortDescription" class="mb-3">Nous recherchons un développeur frontend talentueux pour rejoindre notre équipe et contribuer au développement de nos applications web innovantes.</p>
                <div class="mb-3">
                  <h6>Compétences requises:</h6>
                  <div id="preview-skills" class="d-flex flex-wrap gap-1 mb-2">
                    <span class="badge bg-light text-dark">JavaScript</span>
                    <span class="badge bg-light text-dark">React</span>
                    <span class="badge bg-light text-dark">Node.js</span>
                    <span class="badge bg-light text-dark">CSS</span>
                    <span class="badge bg-light text-dark">HTML5</span>
                  </div>
                </div>
                <div class="text-muted small">
                  <i class="far fa-calendar-alt me-1"></i> Date de publication: <span id="preview-publicationDate">Aujourd'hui</span>
                </div>
              </div>
            </div>
          </div>

          <div class="alert alert-info" role="alert">
            <i class="fas fa-info-circle me-2"></i>
            <strong>Note:</strong> Votre plan actuel vous permet de publier <strong>10</strong> offres d'emploi par mois. Il vous reste <strong>7</strong> offres à publier ce mois-ci.
          </div>

          <div class="d-flex justify-content-between mt-4">
            <button type="button" class="btn btn-outline-secondary prev-step" data-target="step3">
              <i class="fas fa-arrow-left me-2"></i> Précédent
            </button>
            <div>
              <button type="button" class="btn btn-outline-secondary me-2" id="saveAsDraft">
                <i class="fas fa-save me-1"></i> Enregistrer comme brouillon
              </button>
              <button type="submit" class="btn btn-success">
                <i class="fas fa-paper-plane me-1"></i> Publier l'offre
              </button>
            </div>
          </div>
        </div>
      </form>
    </div>
  </div>

  <!-- CSS pour le visuel des compétences et étapes -->
  <style>
    /* Styles pour les étapes de progression */
    .progress-step {
      text-align: center;
      position: relative;
      padding-bottom: 20px;
    }

    .progress-step-number {
      width: 32px;
      height: 32px;
      background-color: #e9e9e9;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      margin: 0 auto 8px;
      font-weight: 600;
      color: #6c757d;
      position: relative;
      z-index: 2;
    }

    .progress-step.active .progress-step-number {
      background-color: #14a800;
      color: white;
    }

    .progress-step-label {
      font-size: 0.85rem;
      color: #6c757d;
    }

    .progress-step.active .progress-step-label {
      color: #333333;
      font-weight: 500;
    }

    /* Affichage des étapes du formulaire */
    .form-step {
      display: none;
    }

    .form-step.active {
      display: block;
    }

    /* Style des titres de section */
    .form-section-title {
      border-bottom: 1px solid #e9e9e9;
      padding-bottom: 10px;
      margin-bottom: 20px;
      color: #14a800;
    }

    /* Styles pour les badges de compétences */
    .selected-skills {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-top: 10px;
    }

    .skill-badge {
      background-color: rgba(20, 168, 0, 0.1);
      color: #14a800;
      border-radius: 30px;
      padding: 5px 12px;
      font-size: 0.85rem;
      display: flex;
      align-items: center;
    }

    .skill-badge .remove-badge {
      background: none;
      border: none;
      color: #6c757d;
      margin-left: 5px;
      padding: 0;
      font-size: 0.85rem;
      cursor: pointer;
    }

    /* Styles pour les badges de langues */
    .selected-languages {
      display: flex;
      flex-direction: column;
      gap: 8px;
      margin-top: 10px;
    }

    .language-badge {
      background-color: #f8f9fa;
      border-radius: 5px;
      padding: 8px 12px;
      font-size: 0.85rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .language-badge .language-name {
      font-weight: 500;
    }

    .language-badge .language-level {
      background-color: #1f57c3;
      color: white;
      border-radius: 30px;
      padding: 2px 10px;
      font-size: 0.75rem;
    }

    /* Style de l'aperçu de l'offre */
    .job-preview {
      border-left: 4px solid #14a800;
      padding-left: 15px;
    }

    /* Style des questions de présélection */
    .question-item {
      background-color: white;
      border-radius: 5px;
      padding: 10px;
    }

    /* Style pour les badges dans l'aperçu */
    #preview-skills .badge {
      padding: 5px 10px;
      margin-right: 5px;
      margin-bottom: 5px;
    }
  </style>
</div>